{
  "version": "3.39.1.427",
  "description": "Tencent Meeting | 腾讯会议",
  "homepage": "https://meeting.tencent.com/",
  "license": { "identifier": "Freemium" },

  "notes": [
    "Installation dir (绿色目录): $dir",
    "User data is persisted via Scoop 'persist' feature."
  ],

  "architecture": {
    "64bit": {
      /* 直接加  #/dl.7z  解包，完全不跑官方安装器 */
      "url": "https://updatecdn.meeting.qq.com/cos/9a27d0a6b9faf68786d997cea293a201/TencentMeeting_0300000000_3.39.1.427_x86_64.publish.exe#/dl.7z",
      "hash": "05b8c52eacc6109ebfec5cc7931028596478dfc400dc385d76aea879f07cc859"
    }
  },

  /* 解压后真正程序所在的子目录 */
  "extract_dir": "WeMeet",

  "shortcuts": [
    [ "WeMeetApp.exe", "腾讯会议" ]
  ],

  /* 常见用户数据目录，可根据实际再添删 */
  "persist": [
    "data",
    "WeMeetStorage"
  ],

  /* ---------- 自动检查更新 ---------- */
  "checkver": {
    "script": [
      "$ver = (Invoke-RestMethod 'https://api.github.com/repos/microsoft/winget-pkgs/contents/manifests/t/Tencent/TencentMeeting' |",
      "        Where-Object name -notmatch '^\\.' |",
      "        Sort-Object {[version]$_} -Descending | Select-Object -First 1).name",
      "$yaml = Invoke-RestMethod \"https://raw.githubusercontent.com/microsoft/winget-pkgs/master/manifests/t/Tencent/TencentMeeting/$ver/Tencent.TencentMeeting.installer.yaml\"",
      "$m = [regex]::Match($yaml, 'InstallerUrl:\\s*https://updatecdn\\.meeting\\.qq\\.com/(.+_x86_64.+)')",
      \"version:$ver;path_x64:$($m.Groups[1].Value)\"
    ],
    "regex": "version:(?<version>[^;]+);path_x64:(?<path_x64>.+)"
  },

  "autoupdate": {
    "architecture": {
      "64bit": {
        "url": "https://updatecdn.meeting.qq.com/$matchPath_x64#/dl.7z"
      }
    },
    "hash": {
      "url": "https://raw.githubusercontent.com/microsoft/winget-pkgs/master/manifests/t/Tencent/TencentMeeting/$version/Tencent.TencentMeeting.installer.yaml",
      "regex": "- Architecture:\\s*x64[\\s\\S]+?InstallerSha256:\\s*$sha256"
    }
  }
}

