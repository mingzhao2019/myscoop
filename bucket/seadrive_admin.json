{
    "version": "3.0.10",
    "homepage": "https://www.seafile.com",
    "description": "Exposes Seafile servers as Windows network drives.",
    "license": "Proprietary",
    "architecture": {
        "64bit": {
            "url": "https://s3.eu-central-1.amazonaws.com/download.seadrive.org/seadrive-3.0.10-en.msi",
            "hash": "abeafe131142cc5a76938679e30a26d0664bbbf47298af7ac9a531aeca01260f"
        }
    },
    "shortcuts": [
        [
            "PFiles/SeaDrive/bin/seadrive-gui.exe",
            "SeaDrive-GUI"
        ]
    ],
    "checkver": {
        "url": "https://www.seafile.com/en/download/",
        "regex": "(?<url>https://[^\"]*seadrive-(?<version>\\d+\\.\\d+\\.\\d+)-en\\.msi)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://s3.eu-central-1.amazonaws.com/download.seadrive.org/seadrive-$version-en.msi"
            }
        }
    },
    "installer": {
        "script": [
            "$msiFile = \"$dir\\seadrive-$version-en.msi\"",
            "if (Test-Path $msiFile) {",
            "    Write-Host 'Installing SeaDrive with administrator privileges...'",
            "    $process = Start-Process msiexec.exe -Wait -ArgumentList @('/i', $msiFile, '/qn', 'ALLUSERS=1') -Verb RunAs -PassThru",
            "    if ($process.ExitCode -eq 0) {",
            "        Write-Host 'Installation successful.'",
            "        Remove-Item $msiFile",
            "    } else {",
            "        Write-Host \"Installation failed with exit code $($process.ExitCode)\"",
            "        exit 1",
            "    }",
            "} else {",
            "    Write-Host 'MSI file not found. Installation cannot proceed.'",
            "    exit 1",
            "}"
        ]
    }
}
