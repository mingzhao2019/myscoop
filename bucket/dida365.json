{
    "version": "6.0.1.0",
    "description": "让你的 Windows 电脑成为高效办公平台",
    "license": "Unknown",
    "architecture": {
        "64bit": {
            "url": "https://dida365.com/static/getApp/download?type=win64",
            "hash": "5bd339c215d93c9ad6d6614010d7b043bd7914fcb7efd05050ed634ec2b7eacf"
        },
        "32bit": {
            "url": "https://dida365.com/static/getApp/download?type=win",
            "hash": "9ed1557f84546d10e50b842c179ca7c5359dd31d2a6f63edd5021c1e37e36273"
        }
    },
    "innosetup": true,
    "homepage": "https://www.dida365.com/",
    "shortcuts": [
        [
            "TickTick.exe",
            "TickTick"
        ]
    ],
    "pre_install": [
        "$url64 = 'https://dida365.com/static/getApp/download?type=win64'",
        "$url32 = 'https://dida365.com/static/getApp/download?type=win'",
        "$resp64 = Invoke-WebRequest -Uri $url64 -MaximumRedirection 0 -ErrorAction Ignore",
        "$resp32 = Invoke-WebRequest -Uri $url32 -MaximumRedirection 0 -ErrorAction Ignore",
        "$actualUrl64 = $resp64.Headers['Location']",
        "$actualUrl32 = $resp32.Headers['Location']",
        "if ($architecture -eq '64bit') {",
        "    $actualUrl = $actualUrl64",
        "} else {",
        "    $actualUrl = $actualUrl32",
        "}",
        "$global:actualUrl = $actualUrl"
    ],
    "installer": {
        "script": [
            "Invoke-WebRequest -Uri $global:actualUrl -OutFile $dir\\dida365_installer.exe",
            "Start-Process -FilePath $dir\\dida365_installer.exe -ArgumentList '/VERYSILENT' -Wait"
        ]
    },
    "checkver": {
        "url": "https://dida365.com/static/getApp/download?type=win64",
        "script": [
            "$resp = Invoke-WebRequest -Uri $url -MaximumRedirection 0 -ErrorAction Ignore",
            "$location = $resp.Headers['Location']",
            "$matchHead = [regex]::Match($location, 'release_x64_([\\d]+).exe').Groups[1].Value",
            "$version = \"$($matchHead.Substring(0, 1)).$($matchHead.Substring(1, 1)).$($matchHead.Substring(2, 1)).$($matchHead.Substring(3))\"",
            "Write-Output $version"
        ],
        "regex": "([\\d.]+)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://dida365.com/static/getApp/download?type=win64",
                "hash": {
                    "url": "$url.sha256"
                }
            },
            "32bit": {
                "url": "https://dida365.com/static/getApp/download?type=win",
                "hash": {
                    "url": "$url.sha256"
                }
            }
        }
    }
}
